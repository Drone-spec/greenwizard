<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>

        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>A Dell Incantation - A Wizards Tomes</title>
        <!-- Custom HTML head -->
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
<div class="glitch-skew"></div>
<div class="scanlines"></div>
<div class="scanline"></div>
<div class="flicker"></div>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="Wizardintro.html">A Wizards Legacy</a></li><li class="spacer"></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> Offensive Focus</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="Tome1.html"><strong aria-hidden="true">1.1.</strong> Terminal trolling</a></li><li class="chapter-item expanded "><a href="Tome22.html"><strong aria-hidden="true">1.2.</strong> Powershell Hexing</a></li><li class="chapter-item expanded "><a href="Tome2.html"><strong aria-hidden="true">1.3.</strong> Git with vengeance</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Defensive Focus</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="TomeBooger.html"><strong aria-hidden="true">2.1.</strong> Booger Goblin</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Development Focus</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="Tome3.html"><strong aria-hidden="true">3.1.</strong> Embedded magic</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Infrastructure Focus</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="Tome5.html" class="active"><strong aria-hidden="true">4.1.</strong> A Dell Incantation</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Forbidden Wizard Magics</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">5.1.</strong> PlaceHolder</div></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Yapping Crystal</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="Tome4.html"><strong aria-hidden="true">6.1.</strong> A Wizards Jade</a></li><li class="chapter-item expanded "><a href="ics/ics1.html"><strong aria-hidden="true">6.2.</strong> A tale of Trains</a></li><li class="spacer"></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="matrix">Matrix</button></li> 
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">A Wizards Tomes</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="dellservergpufanissue"><a class="header" href="#dellservergpufanissue">DellserverGPUfanissue</a></h1>
<p>Read my story to fix your issue.</p>
<p>Sorry for the wizard fun but I hate dry write ups and you can just copy paste and ignore my rambling. </p>
<h2 id="chapter-1-the-problem"><a class="header" href="#chapter-1-the-problem">Chapter 1, The problem</a></h2>
<hr />
<p>Welcome fellow techno sewergoblin. If you found this then you too have put an unsuppored GPU inside of that wonderful dell server you are about to commit unholy sins against in the persuit of the perfect homelab. </p>
<p>The bad news. That fan sucks mega butts contantly trying to take off with its fans spinning at like 75 to 85 percent for NO REASON.. Well as it turns out there is a reason and I had to ponder some Old arcane tomes to understand the issue.</p>
<h2 id="chapter-2-pondering-old-orbs"><a class="header" href="#chapter-2-pondering-old-orbs">Chapter 2, Pondering old orbs</a></h2>
<hr />
<p>Deep in the back pages of spiceworks fourms. In the year of our lord 2023 I stumbled into this.</p>
<p>https://community.spiceworks.com/topic/613098-dell-poweredge-server-r7xx-series-fan-speed-with-gpu</p>
<p>Full of wizard sharing in their woes as one mighty hero would deliver us from our struggles. SUFFER NO MORE this hero said. <em>alexrozentuller</em> you mighty wizard! I salute you.</p>
<pre><code>Dell traced the issue back to a setting for how they handle unmatched devices.  They were able to run the following IPMI command on my 730's to resolve the issue:

ipmitool.exe -H 172.16.171.21 -U root -P calvin raw 20 30 0x00 ce 0 0x16 5 0 0 0 5 0 1 0 0    &gt; Set Unmatched Logic Disabled

*** USE AT YOUR OWN RISK ***﻿

﻿Dell was very hesitant to provide me with the above command, so it is not official by any means.  I forwarded the details to Teradici under ticket reference: #15134-33400.  ﻿I would give them a ring first.

If that doesnt get you anywhere, i provided my Dell ticket in an earlier post: SER# 81901735650.﻿  See if you can reference that with Dell directly.

Good Luck!

</code></pre>
<p>As we gaze at this script of old we find the command and values we need.</p>
<pre><code>ipmitool -I lanplus -H &lt;IP of the IDRAC&gt; -U &lt;user&gt; -P &lt;password&gt; raw 0x30 0xce 0x00 0x16 0x05 0x00 0x00 0x00 0x05 0x00 0x01 0x00 0x00
</code></pre>
<p>Ah and here we have a great example of PRIME magic, This is undistilled wizard juice. The good stuff.</p>
<h2 id="chapter-3-tapping-ancient-power"><a class="header" href="#chapter-3-tapping-ancient-power">Chapter 3, Tapping ancient power</a></h2>
<hr />
<p>With our new found words of power we must build our foundation.</p>
<p>Step 1. Log into your dell IDRAC</p>
<p>Step 2. Once Logged in on the left hand side under IDRAC Settings, click on User Authentication</p>
<p>Step 3. Make a user with a password containing no symbols, Down one box should be IPMI USSER PRIVILEGES, set Maximum LAN User Privilege Granted to Administrator.</p>
<p>Step 4. Hit APPLY</p>
<p>Step 5. On the Far Left hand side under iDRAC SETTINGS, Select Network, Scroll to the bottom and located the IPMI Settings, check the box for Enable IPMI Over LAN</p>
<p>Step 6. Hit APPLY</p>
<p>We have now pregamed the server for IPMI wizard magic. Let us now begin the incantation.</p>
<h2 id="chapter-4-activating-ancient-power"><a class="header" href="#chapter-4-activating-ancient-power">Chapter 4, Activating ancient power</a></h2>
<hr />
<p>I am using Endevour OS, so let me tip my wizard hat because I used arch BTW.</p>
<pre><code>yay ipmitool  &lt; yay wizards

apt-get install ipmitool &lt; Normal Linux users
</code></pre>
<p>if you want to self compile
https://github.com/ipmitool/ipmitool</p>
<p>For all my powershell surfers here is the windows Dell support pack 
https://www.dell.com/support/home/en-us/drivers/driversdetails?driverid=w9nmr</p>
<p>once you have ipmitools let me give a rundown on the actual command, You could spare me this pain and read the man page or the -h but here it is anyway</p>
<p>ipmitool -I lanplus -H <IP of the IDRAC> -U <user> -P <password> raw 0x30 0xce 0x00 0x16 0x05 0x00 0x00 0x00 0x05 0x00 0x01 0x00 0x00</p>
<p>-I is the interface method 
-H is the ip of your iDrac 
-U is the user with ipmi permissions
-P is password
Raw is the data type</p>
<p>0x30 0xce 0x00 0x16 0x05 0x00 0x00 0x00 0x05 0x00 0x01 0x00 0x00
This above is Set Third-Party PCIe Card Default Cooling Response Logic To Disabled</p>
<p>Mad shout out to <em>mikemattran</em> for the Disable, Enable, and Status codes</p>
<pre><code>Set Third-Party PCIe Card Default Cooling Response Logic To Disabled

ipmitool -I lanplus -H -U -P raw 0x30 0xce 0x00 0x16 0x05 0x00 0x00 0x00 0x05 0x00 0x01 0x00 0x00 

Set Third-Party PCIe Card Default Cooling Response Logic To Enabled

ipmitool -I lanplus -H -U -P raw 0x30 0xce 0x00 0x16 0x05 0x00 0x00 0x00 0x05 0x00 0x00 0x00 0x00 

Get Third-Party PCIe Card Default Cooling Response Logic Status

ipmitool -I lanplus -H -U -P raw 0x30 0xce 0x01 0x16 0x05 0x00 0x00 0x00 

The response data is:

16 05 00 00 00 05 00 01 00 00 (Disabled)

﻿16 05 00 00 00 05 00 00 00 00 (Enabled)
</code></pre>
<p>Once the dust settles and peace returns to your wizard homelab. We can all take a deep breath as we are free from the loathsum Dell GPU fan curse.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="Tome3.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="Tome4.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="Tome3.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="Tome4.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script>
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>
        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="mermaid.min.js"></script>
        <script src="mermaid-init.js"></script>
    </div>
    </body>
</html>
